<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ULTRA Production Leaderboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
    font-family: Arial, sans-serif;
    background:#f4f6f8;
    margin:0;
    padding:15px;
}

h1{text-align:center;}

.header{
    display:flex;
    justify-content:space-between;
    align-items:center;
}

.card{
    background:#fff;
    border-radius:12px;
    padding:15px;
    margin:12px 0;
    box-shadow:0 2px 6px rgba(0,0,0,0.1);
}

/* ===== BOARD ===== */

.rank{
    background:#ddd;
    border-radius:6px;
    display:inline-block;
    padding:4px 8px;
    font-weight:bold;
}

.blue{background:#2979ff;color:#fff;}
.greenbg{background:#43a047;color:#fff;}
.redbg{background:#FDDA0D;color:#fff;}

progress{
    width:100%;
    height:18px;
}

/* ===== DARK MODE ===== */

body.dark{
    background:#121212;
    color:#eee;
}
.dark .card{background:#1e1e1e;}
.dark input,.dark button{
    background:#333;
    color:#fff;
    border-color:#555;
}

/* ===== INPUTS ===== */

input{
    width:80px;
    padding:6px;
}
button{
    padding:7px 12px;
    border-radius:6px;
}

.lock{text-align:center;margin-bottom:20px;}
.input-row{display:flex;gap:10px;align-items:center;}

.green{color:#00cc5a;font-weight:bold;}
.red{color:#ff4a4a;font-weight:bold;}

.timestamp{
    font-size:11px;
    color:#777;
    position:absolute;
    right:10px;
    top:8px;
}

/* ===== BAUBLES ===== */

.swing-wrapper{
    position:absolute;
    top:0;
    transform-origin: top center;
    animation:swing ease-in-out infinite alternate;
}

@keyframes swing{
    from{transform:rotate(-6deg);}
    to{transform:rotate(6deg);}
}

.string{
    width:2px;
    background:rgba(0,0,0,0.7);
    margin:0 auto;
}

.bauble{
    border-radius:50%;
    margin:0 auto;
    background:
      radial-gradient(circle at 35% 30%, #fff 5%, var(--c1) 35%, var(--c2) 80%);
    box-shadow:
        inset -2px -4px 8px rgba(0,0,0,.35),
        0 0 7px rgba(255,255,255,.35);
}

/* ===== SNOW ===== */

#snow{
    position:fixed;
    inset:0;
    pointer-events:none;
    z-index:999;
}

.snowflake{
    position:absolute;
    top:-10px;
    background:white;
    border-radius:50%;
    filter: blur(.4px);
    opacity:.9;
    animation:fall linear infinite, drift ease-in-out infinite;
}

@keyframes fall{
    to{transform:translateY(110vh);}
}

@keyframes drift{
    0%,100%{margin-left:0;}
    50%{margin-left:25px;}
}
</style>
</head>

<body>

<div id="snow"></div>

<div class="header">
    <h1>ULTRA Production Leaderboard</h1>
    <button onclick="toggleDark()">ðŸŒ™ Dark Mode</button>
</div>

<div class="lock">
<h3>Enter PIN to unlock editing</h3>
<input type="password" id="pinInput" maxlength="4">
<button onclick="unlock()">Unlock</button>
</div>

<div id="board"></div>

<div class="footer" style="text-align:center;color:#777;">
Target: <b>4,000 parts/hr</b> â€¢ Daily target: <b>36,000 parts</b>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
firebase.initializeApp({
 apiKey: "AIzaSyBjEcJRy9C_WXJYhqLaBEZJ54ZwpEgH8qE",
 authDomain: "ultra-production-board.firebaseapp.com",
 projectId: "ultra-production-board",
 storageBucket: "ultra-production-board.firebasestorage.app",
 messagingSenderId: "1058393515822",
 appId: "1:1058393515822:web:a706cdbc8c02cc0c0e3cbf"
});

const db=firebase.database();

const PIN="0711";
const DAILY_TARGET=36000;
let unlocked=false;

const teams=["ULTRA1","ULTRA2","ULTRA3"];

function toggleDark(){
    document.body.classList.toggle("dark");
}

function unlock(){
    if(pinInput.value===PIN){
        unlocked=true;
        document.querySelector(".lock").style.display="none";
        loadBoard();
    } else alert("Wrong PIN");
}

function loadBoard(){
    db.ref("production").on("value",s=>{
        renderBoard(s.val()||{});
    });
}

function save(name){
    db.ref("production/"+name).set({
        total:+document.getElementById(name).value,
        lastUpdated:new Date().toLocaleTimeString([],{
            hour:"2-digit",
            minute:"2-digit"
        })
    });
}

function renderBoard(data){

    const totals=teams.map(t=>({name:t,total:data[t]?.total||0}))
                      .sort((a,b)=>b.total-a.total);

    board.innerHTML="";

    totals.forEach((team,i)=>{

        const pct=Math.min(team.total/DAILY_TARGET*100,100);

        board.innerHTML+=`
<div class="card" style="position:relative">
<span class="rank">#${i+1}</span>
<span class="${team.name=="ULTRA1"?"blue":team.name=="ULTRA2"?"greenbg":"redbg"}">${team.name}</span>

<div class="input-row">
<input id="${team.name}" type="number" value="${team.total}" ${unlocked?"":"disabled"}>
<button onclick="save('${team.name}')" ${unlocked?"":"disabled"}>Update</button>
</div>

<progress value="${pct}" max="100"></progress>

<p>${team.total} parts</p>

<p class="timestamp">
Last update: ${data[team.name]?.lastUpdated||"--"}
</p>
</div>`;
    });

}

/* ===== BAUBLES ===== */

const colors=[["#ff3366","#a1002b"],["#ffd24a","#a77300"],
              ["#44ffaa","#007c43"],["#7b6bff","#281d88"]];

for(let i=0;i<9;i++){
    const wrap=document.createElement("div");
    wrap.className="swing-wrapper";

    wrap.style.left=(5+i*(90/9))+"%";
    wrap.style.animationDuration=(3+Math.random()*2)+"s";

    const d=40+Math.random()*60;

    const s=document.createElement("div");
    s.className="string";
    s.style.height=d+"px";

    const b=document.createElement("div");
    b.className="bauble";

    const size=20+Math.random()*15;
    b.style.width=b.style.height=size+"px";

    const c=colors[Math.floor(Math.random()*colors.length)];
    b.style.setProperty("--c1",c[0]);
    b.style.setProperty("--c2",c[1]);

    wrap.appendChild(s);
    wrap.appendChild(b);
    document.body.appendChild(wrap);
}

/* ===== SNOW ===== */

const snow=document.getElementById("snow");

setInterval(()=>{
    const flake=document.createElement("div");
    flake.className="snowflake";

    const size=Math.random()*5+2;
    flake.style.width=flake.style.height=size+"px";
    flake.style.left=Math.random()*100+"vw";

    const speed=Math.random()*6+5;
    flake.style.animationDuration=speed+"s,3s";

    snow.appendChild(flake);

    setTimeout(()=>flake.remove(),(speed+1)*1000);
},90);

</script>

</body>
</html>
